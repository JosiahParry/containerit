<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generating Dockerfiles for reproducible research with R • containerit</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Generating Dockerfiles for reproducible research with R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">containerit</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/containerit.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic.html">Introduction to package `containerit`</a>
    </li>
    <li>
      <a href="../articles/container.html">Using `containerit` Docker image</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/o2r/containerit/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Generating Dockerfiles for reproducible research with R</h1>
                        <h4 class="author">Matthias Hinz, Daniel Nüst</h4>
            
            <h4 class="date">2018-03-26</h4>
      
      <small>Source: <a href="https://github.com/o2r/containerit//blob/master/vignettes/containerit.Rmd"><code>vignettes/containerit.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">require</span>(<span class="st">"knitr"</span>)</a></code></pre></div>
<pre><code>## Loading required package: knitr</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">temp_workspace &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">pattern =</span> <span class="st">"containerit_temp"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">dir.create</span>(temp_workspace)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">opts_knit<span class="op">$</span><span class="kw">set</span>(<span class="dt">root.dir =</span> temp_workspace)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h2>
<p>Even though R is designed for open and reproducible research, users who want to share their work with others are facing challenges. Sharing merely the R script or R Markdown document should warrant reproducibility, but many analyses rely on additional resources and specific third party software as well. An R script may produce unexpected results or errors when executed under a different version of R or another platform. Reproduciblility is only assured by providing complete setup instructions and resources. Long-term reproducibility can be achieved by either regular maintenance of the code, i.e. keeping it always working with the latest package versions from CRAN. It can be supported by packages such as <a href="https://rstudio.github.io/packrat/">packrat</a> and platforms such as <a href="https://mran.microsoft.com/">MRAN</a>, which provide means to capture a specific combination of R packages. An alternative to updating or managing packages explicitly is providing the full runtime environment in its original state, using <a href="https://en.wikipedia.org/wiki/Virtual_machine">virtual machines</a> or <a href="https://en.wikipedia.org/wiki/Operating-system-level_virtualization">software containers</a>.</p>
<p>The R extension package <code>containerit</code> aims to facilitate the latter approach by making reproducible and archivable research with containers easier. The development is supported by the DFG-funded project Opening Reproducible Research (o2r, <a href="http://o2r.info" class="uri">http://o2r.info</a>). <code>containerit</code> relies on <a href="http://docker.com/">Docker</a> and automatically generates a container manifest, or “recipe”, with setup instructions to recreate a runtime environment based on a given R session, R script, R Markdown file or workspace directory. The resulting <a href="https://docs.docker.com/engine/reference/builder/"><code>Dockerfile</code></a> can not only be read and understood by humans, but also be interpreted by the Docker engine to create a software container containing all the R packages and their system dependencies. This way all requirements of an R workflow are packaged in an executable format.</p>
<p>The created Dockerfiles are based on the <a href="https://github.com/rocker-org/rocker">Rocker</a> project (<a href="https://hub.docker.com/u/rocker/">Rocker on Docker Hub</a>, <a href="http://dirk.eddelbuettel.com/blog/2014/10/23/#introducing_rocker">introduction</a>). Using the stack of version-stable Rocker images, it is possible to match the container’s R version with the local R installation or any R version the user requires. <code>containerit</code> executes the provided input workspace or file first locally on the host machine in order to detect all dependencies. For determining external software dependencies of attached packages, <code>containerit</code> relies (a) on the <a href="https://sysreqs.r-hub.io/">sysreqs database</a> and makes use of the corresponding web API and R package, and (b) on internally defined rule sets for challenging configurations.</p>
<p>The Dockerfile created by <code>containerit</code> can then be used to build a Docker image. Running the image will start an R session that closely resembles the creating systems runtime environment. The image can be shared and archived and works anywhere with a compatible Docker version.</p>
<p>To build images and run containers, the package integrates with the <a href="https://github.com/wch/harbor">harbor</a> package and adds a few convenience functions for interacting with Docker images and containers. For concrete details on reading, loading, or installing the <em>exact</em> versions of R packages including their system dependencies/libraries, this project focuses on the geospatial domain. <code>containerit</code> uses the package <a href="https://cran.r-project.org/web/packages/futile.logger/"><code>futile.logger</code></a> to provide information to the user at a configurable level of detail, see <a href="https://cran.r-project.org/web/packages/futile.logger/README.html">futile.logger documentation</a>.</p>
<p>In the remainder of this vignette, we first introduce the main usage scenarios for <code>containerit</code> and document current challenges as well as directions for future work.</p>
</div>
<div id="creating-a-dockerfile" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-dockerfile" class="anchor"></a>2. Creating a Dockerfile</h2>
<div id="basics" class="section level3">
<h3 class="hasAnchor">
<a href="#basics" class="anchor"></a>2.1 Basics</h3>
<p>The easiest way to generate a Dockerfile is to run an analysis in an interactive R session and create a Dockerfile for this session by loading <code>containerit</code> and calling the <code><a href="../reference/dockerfile.html">dockerfile()</a></code>- method with default parameters. As shown in the example below, the result can be pretty-printed and written to a file. If no <code>file</code> argument is supplied to <code>write()</code>, the Dockerfile is written to the current working directory as <code>./Dockerfile</code>, following the typical naming convention of Docker.</p>
<p>When packaging any resources, it is essential that the R working directory is the same as the build context, to which the Dockerfile refers. All resources must be located below this directory so that they can be refered to by relative paths (e.g. for copy instructions). This must also be considered when packaging R scripts that use relative paths, e.g. for reading a file or sourcing another R script.</p>
</div>
<div id="packaging-an-interactive-session" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-an-interactive-session" class="anchor"></a>2.2 Packaging an interactive session</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(<span class="st">"containerit"</span>)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'containerit'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     Arg</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># do stuff, based on demo("krige")</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(<span class="st">"gstat"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw">library</span>(<span class="st">"sp"</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">data</span>(meuse)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="http://www.rdocumentation.org/packages/sp/topics/coordinates">coordinates</a></span>(meuse) =<span class="st"> </span><span class="er">~</span>x<span class="op">+</span>y</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">data</span>(meuse.grid)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw"><a href="http://www.rdocumentation.org/packages/sp/topics/gridded-methods">gridded</a></span>(meuse.grid) =<span class="st"> </span><span class="er">~</span>x<span class="op">+</span>y</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">v &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/gstat/topics/variogram">variogram</a></span>(<span class="kw">log</span>(zinc)<span class="op">~</span><span class="dv">1</span>, meuse)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">m &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/gstat/topics/fit.variogram">fit.variogram</a></span>(v, <span class="kw"><a href="http://www.rdocumentation.org/packages/gstat/topics/vgm">vgm</a></span>(<span class="dv">1</span>, <span class="st">"Sph"</span>, <span class="dv">300</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">plot</span>(v, <span class="dt">model =</span> m)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># create Dockerfile representation</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">dockerfile_object &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>()</a></code></pre></div>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package containerit. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package harbor. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>## INFO [2018-03-26 22:23:10] Going online? TRUE  ... to retrieve system dependencies (sysreq-api)
## INFO [2018-03-26 22:23:10] Trying to determine system requirements for the package(s) 'sp,gstat,knitr,Rcpp,futile.logger,harbor,plyr,xts,futile.options,sys,digest,jsonlite,evaluate,memoise,lattice,rlang,rstudioapi,commonmark,yaml,pkgdown,stringr,roxygen2,xml2,desc,fs,rprojroot,spacetime,R6,rmarkdown,lambda.r,semver,magrittr,intervals,backports,scales,htmltools,MASS,assertthat,colorspace,stringi,munsell,FNN,crayon,zoo,remotes' from sysreqs online DB
## INFO [2018-03-26 22:23:12] Adding CRAN packages: assertthat, backports, colorspace, commonmark, crayon, desc, digest, evaluate, FNN, fs, futile.logger, futile.options, gstat, htmltools, intervals, jsonlite, knitr, lambda.r, lattice, magrittr, MASS, memoise, munsell, plyr, R6, Rcpp, remotes, rlang, rmarkdown, roxygen2, rprojroot, rstudioapi, scales, semver, sp, spacetime, stringi, stringr, sys, xml2, xts, yaml, zoo
## INFO [2018-03-26 22:23:12] Adding GitHub packages: r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910
## INFO [2018-03-26 22:23:12] Created Dockerfile-Object based on sessionInfo</code></pre>
<p>The representation of a Dockerfile in R is an instance of the S4 class <code>Dockerfile</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">dockerfile_object</a></code></pre></div>
<pre><code>## An object of class "Dockerfile"
## Slot "image":
## An object of class "From"
## Slot "image":
## [1] "rocker/r-ver"
## 
## Slot "postfix":
## An object of class "Tag"
## [1] "3.4.4"
## 
## 
## Slot "maintainer":
## An object of class "Label"
## Slot "data":
## $maintainer
## [1] "daniel"
## 
## 
## Slot "multi_line":
## [1] FALSE
## 
## 
## Slot "instructions":
## [[1]]
## An object of class "Run_shell"
## Slot "commands":
## [1] "export DEBIAN_FRONTEND=noninteractive; apt-get -y update"                                                         
## [2] "apt-get install -y git-core \\\n\tlibapparmor-dev \\\n\tlibxml2-dev \\\n\tmake \\\n\tpandoc \\\n\tpandoc-citeproc"
## 
## 
## [[2]]
## An object of class "Run"
## Slot "exec":
## [1] "install2.r"
## 
## Slot "params":
##       assertthat        backports       colorspace       commonmark 
##     "assertthat"      "backports"     "colorspace"     "commonmark" 
##           crayon             desc           digest         evaluate 
##         "crayon"           "desc"         "digest"       "evaluate" 
##              FNN               fs    futile.logger   futile.options 
##            "FNN"             "fs"  "futile.logger" "futile.options" 
##            gstat        htmltools        intervals         jsonlite 
##          "gstat"      "htmltools"      "intervals"       "jsonlite" 
##            knitr         lambda.r          lattice         magrittr 
##          "knitr"       "lambda.r"        "lattice"       "magrittr" 
##             MASS          memoise          munsell             plyr 
##           "MASS"        "memoise"        "munsell"           "plyr" 
##               R6             Rcpp               45            rlang 
##             "R6"           "Rcpp"        "remotes"          "rlang" 
##        rmarkdown         roxygen2        rprojroot       rstudioapi 
##      "rmarkdown"       "roxygen2"      "rprojroot"     "rstudioapi" 
##           scales           semver               sp        spacetime 
##         "scales"         "semver"             "sp"      "spacetime" 
##          stringi          stringr              sys             xml2 
##        "stringi"        "stringr"            "sys"           "xml2" 
##              xts             yaml              zoo 
##            "xts"           "yaml"            "zoo" 
## 
## 
## [[3]]
## An object of class "Run"
## Slot "exec":
## [1] "installGithub.r"
## 
## Slot "params":
##                                                  pkgdown 
## "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910" 
## 
## 
## [[4]]
## An object of class "Workdir"
## Slot "path":
## [1] "/payload/"
## 
## 
## 
## Slot "entrypoint":
## NULL
## 
## Slot "cmd":
## An object of class "Cmd"
## Slot "exec":
## [1] "R"
## 
## Slot "params":
## [1] NA
## 
## Slot "form":
## [1] "exec"</code></pre>
<p>The printout below shows the rendered Dockerfile. Its instructions follow a pre-defined order:</p>
<ol style="list-style-type: decimal">
<li>define the base image</li>
<li>define the maintainer label</li>
<li>install system dependencies and external software</li>
<li>install the R packages themselves</li>
<li>set the working directory</li>
<li>copy instructions and metadata labels (see examples in later sections)</li>
<li>
<code>CMD</code> instruction (final line) defines the default command when running the container</li>
</ol>
<p>Note that the maintainer label as well as the R version of the base image are detected from the runtime environment, if not set to different values manually.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">print</span>(dockerfile_object)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
  &amp;&amp; apt-get install -y git-core \
    libapparmor-dev \
    libxml2-dev \
    make \
    pandoc \
    pandoc-citeproc
RUN ["install2.r", "assertthat", "backports", "colorspace", "commonmark", "crayon", "desc", "digest", "evaluate", "FNN", "fs", "futile.logger", "futile.options", "gstat", "htmltools", "intervals", "jsonlite", "knitr", "lambda.r", "lattice", "magrittr", "MASS", "memoise", "munsell", "plyr", "R6", "Rcpp", "remotes", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sp", "spacetime", "stringi", "stringr", "sys", "xml2", "xts", "yaml", "zoo"]
RUN ["installGithub.r", "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910"]
WORKDIR /payload/
CMD ["R"]</code></pre>
<p>Instead of printing out to the console, you can also write to a file:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">write</span>(dockerfile_object, <span class="dt">file =</span> <span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">".dockerfile"</span>))</a></code></pre></div>
<pre><code>## INFO [2018-03-26 22:23:12] Writing dockerfile to /tmp/RtmpOliYOg/file2afe6e3e61ec.dockerfile</code></pre>
</div>
<div id="packaging-an-external-session" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-an-external-session" class="anchor"></a>2.3 Packaging an external session</h3>
<p>Packaging an interactive session has the disadvantage that unnecessary dependencies might be added to the Dockerfile and subsequently to the container. For instance the package <code>futile.logger</code> is a dependency of <code>containerit</code>, and it will be added to the container because it was loaded into the same session were the analyses was executed. It cannot be removed by default, because other packages in the session <em>might</em> use it as well (even unintentionally in case of generic methods). Therefore, it is safer not to tamper with the current session, but to run the analysis in an isolated <em>vanilla</em> session, which does not have <code>containerit</code> in it. The latter will batch-execute the commands in a seperate instance of R and retrieves an object of class <code>sessionInfo</code>. The session info is then used as input to <code><a href="../reference/dockerfile.html">dockerfile()</a></code>. This is also how <code><a href="../reference/dockerfile.html">dockerfile()</a></code> works internally when packaging either expressions, scripts or R markdown files.</p>
<p>The following code creates a Dockerfile for a list of expressions in a vanilla session.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">exp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">library</span>(sp)),</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">         <span class="kw">expression</span>(<span class="kw">data</span>(meuse)), </a>
<a class="sourceLine" id="cb18-3" data-line-number="3">         <span class="kw">expression</span>(<span class="kw">mean</span>(meuse[[<span class="st">"zinc"</span>]])))</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">session &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clean_session.html">clean_session</a></span>(exp, <span class="dt">echo =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## INFO [2018-03-26 22:23:12] Creating an R session with the following arguments:
##   R  --silent --vanilla -e "library(sp)" -e "data(meuse)" -e "mean(meuse[[\"zinc\"]])" -e "info &lt;- sessionInfo()" -e "save(list = \"info\", file = \"/tmp/RtmpOliYOg/rdata-sessioninfo2afe37d60a6a\")"</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">dockerfile_object &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> session)</a></code></pre></div>
<pre><code>## INFO [2018-03-26 22:23:14] Going online? TRUE  ... to retrieve system dependencies (sysreq-api)
## INFO [2018-03-26 22:23:14] Trying to determine system requirements for the package(s) 'sp,lattice' from sysreqs online DB
## INFO [2018-03-26 22:23:15] Adding CRAN packages: lattice, sp
## INFO [2018-03-26 22:23:15] Created Dockerfile-Object based on sessionInfo</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">print</span>(dockerfile_object)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN ["install2.r", "lattice", "sp"]
WORKDIR /payload/
CMD ["R"]</code></pre>
</div>
<div id="packaging-an-r-script" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-an-r-script" class="anchor"></a>2.4 Packaging an R script</h3>
<p>R scripts are packaged by just supplying the file path or paths to the arguement <code>from</code> of <code><a href="../reference/dockerfile.html">dockerfile()</a></code>. They are automatically copied into the container’s working directory. In order to run the R script on start-up, rather than an interactive R session, a CMD instruction can be added by providing the value of the helper function <code><a href="../reference/CMD_Rscript.html">CMD_Rscript()</a></code> as an argument to <code>cmd</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># create simple script file</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">scriptFile &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">pattern =</span> <span class="st">"containerit_"</span>, <span class="dt">fileext =</span> <span class="st">".R"</span>)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="kw">writeLines</span>(<span class="kw">c</span>(<span class="st">'library(rgdal)'</span>,</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">             <span class="st">'nc &lt;- rgdal::readOGR(system.file("shapes/", package="maptools"), "sids", verbose = FALSE)'</span>,</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">             <span class="st">'proj4string(nc) &lt;- CRS("+proj=longlat +datum=NAD27")'</span>,</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">             <span class="st">'plot(nc)'</span>), scriptFile)</a>
<a class="sourceLine" id="cb24-7" data-line-number="7"></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co"># use a custom startup command</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9">scriptCmd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/CMD_Rscript.html">CMD_Rscript</a></span>(<span class="kw">basename</span>(scriptFile))</a>
<a class="sourceLine" id="cb24-10" data-line-number="10"></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co"># create Dockerfile for the script</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12">dockerfile_object &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> scriptFile, <span class="dt">silent =</span> <span class="ot">TRUE</span>, <span class="dt">cmd =</span> scriptCmd)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">print</span>(dockerfile_object)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
  &amp;&amp; apt-get install -y gdal-bin \
    libgdal-dev \
    libproj-dev
RUN ["install2.r", "lattice", "rgdal", "sp"]
WORKDIR /payload/
CMD ["R", "--vanilla", "-f", "containerit_2afe4ee5ae21.R"]</code></pre>
</div>
<div id="packaging-an-r-markdown-file" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-an-r-markdown-file" class="anchor"></a>2.5 Packaging an R Markdown file</h3>
<p>Similarly to scripts, R Markdown files can be passed to the <code>from</code> argument. In the following example, a vignette from the Simple Features package <code>sf</code> is packaged in a container. To render the document at startup, the Dockerfile’s <code>CMD</code> instruction must be changed. To do this, the <code>cmd</code> argument passed to <code><a href="../reference/dockerfile.html">dockerfile()</a></code> is constructed using the function <code>CMD_Render</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">file.copy</span>(<span class="dt">from =</span> <span class="kw">system.file</span>(<span class="st">"doc/sf6.Rmd"</span>, <span class="dt">package =</span> <span class="st">"sf"</span>),</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">          <span class="dt">to =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"sf6.Rmd"</span>),</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">          <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">dockerfile_object &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"sf6.Rmd"</span>),</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">                                <span class="dt">silent =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb27-6" data-line-number="6">                                <span class="dt">cmd =</span> <span class="kw"><a href="../reference/CMD_Render.html">CMD_Render</a></span>(<span class="st">"sf6.Rmd"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">print</span>(dockerfile_object)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
  &amp;&amp; apt-get install -y gdal-bin \
    libgdal-dev \
    libproj-dev
RUN ["install2.r", "lattice", "rgdal", "sp"]
WORKDIR /payload/
CMD ["R", "--vanilla", "-f", "containerit_2afe4ee5ae21.R"]</code></pre>
</div>
<div id="packaging-a-workspace-directory" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-a-workspace-directory" class="anchor"></a>2.6 Packaging a workspace directory</h3>
<p>A typical case expected to be interesting for <code>containerit</code> users is packaging a local directory with a collection of data and code files. If providing a directory path to the <code><a href="../reference/dockerfile.html">dockerfile()</a></code> function, the package searches for the first occurence of an R script, or otherwise the first occurence of an R markdown file. It then proceeds to package this file along with all other resources in the directory, as shown in the next section.</p>
</div>
<div id="packaging-from-a-stored-sessioninfo" class="section level3">
<h3 class="hasAnchor">
<a href="#packaging-from-a-stored-sessioninfo" class="anchor"></a>2.7 Packaging from a stored sessionInfo</h3>
<p>You can also save your <code>sessionInfo()</code> into an <code>Rdata</code> file and create a <code>Dockerfile</code> form it. The <code>sessionInfo</code> object must have the one of the names <code>sessionInfo</code>, <code>sessioninfo</code>, or <code>session_info</code>. It must be the only object in the <code>.Rdata</code> file. This is useful when you want to re-create sessions on different machines.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">"sf"</span>))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">sessionInfo &lt;-<span class="st"> </span><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">save</span>(sessionInfo, <span class="dt">file =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"sessionInfo.Rdata"</span>))</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="kw">unloadNamespace</span>(<span class="st">"sf"</span>)</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"sessionInfo.Rdata"</span>))</a></code></pre></div>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package containerit. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package harbor. Therefore the package cannot be installed in the Docker image.</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>## FROM rocker/r-ver:3.4.4
## LABEL maintainer="daniel"
## RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
##   &amp;&amp; apt-get install -y gdal-bin \
##  git-core \
##  libapparmor-dev \
##  libcurl4-openssl-dev \
##  libgeos-dev \
##  libproj-dev \
##  libssl-dev \
##  libudunits2-dev \
##  libxml2-dev \
##  make \
##  pandoc \
##  pandoc-citeproc \
##  udunits
## RUN ["install2.r", "assertthat", "automagic", "backports", "bindr", "bindrcpp", "class", "classInt", "codetools", "colorspace", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "fs", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "jsonlite", "knitr", "lambda.r", "lattice", "magrittr", "MASS", "memoise", "munsell", "pacman", "pillar", "pkgconfig", "plyr", "purrr", "R6", "Rcpp", "remotes", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sf", "sp", "spacetime", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "withr", "xml2", "xts", "yaml", "zoo"]
## RUN ["installGithub.r", "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910"]
## WORKDIR /payload/
## CMD ["R"]</code></pre>
<p>Two alternative packages provide their own version of a session info, both of which are supported as well. The following examples first load the packages <code>A3</code> and <code>abc</code> (because they are first in the alphabet), store session information objects, and then unload the packages again before creating <code>Dockerfile</code>s from the stored objects.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">"devtools"</span>))</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">"sessioninfo"</span>))</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">"abc"</span>))</a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(<span class="st">"A3"</span>))</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"></a>
<a class="sourceLine" id="cb35-7" data-line-number="7">session_info &lt;-<span class="st"> </span>devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/session_info">session_info</a></span>()</a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="kw">save</span>(session_info, <span class="dt">file =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"session_info_devtools.Rdata"</span>))</a>
<a class="sourceLine" id="cb35-9" data-line-number="9"></a>
<a class="sourceLine" id="cb35-10" data-line-number="10">sessioninfo =<span class="st"> </span>sessioninfo<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/sessioninfo/topics/session_info">session_info</a></span>()</a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="kw">save</span>(sessioninfo, <span class="dt">file =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"session_info.Rdata"</span>))</a>
<a class="sourceLine" id="cb35-12" data-line-number="12"></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="kw">unloadNamespace</span>(<span class="st">"abc"</span>)</a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="kw">unloadNamespace</span>(<span class="st">"A3"</span>)</a>
<a class="sourceLine" id="cb35-15" data-line-number="15"></a>
<a class="sourceLine" id="cb35-16" data-line-number="16">df_sessioninfo &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"session_info.Rdata"</span>))</a>
<a class="sourceLine" id="cb35-17" data-line-number="17">df_devtools &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="kw">file.path</span>(temp_workspace, <span class="st">"session_info_devtools.Rdata"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">print</span>(df_sessioninfo)</a></code></pre></div>
<pre><code>## FROM rocker/r-ver:3.4.4
## LABEL maintainer="daniel"
## RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
##   &amp;&amp; apt-get install -y git-core \
##  libapparmor-dev \
##  libcurl4-openssl-dev \
##  libssl-dev \
##  libudunits2-dev \
##  libxml2-dev \
##  make \
##  pandoc \
##  pandoc-citeproc \
##  udunits
## RUN ["install2.r", "A3", "abc", "abc.data", "assertthat", "automagic", "backports", "bindrcpp", "class", "classInt", "clisymbols", "codetools", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "knitr", "lambda.r", "lattice", "locfit", "magrittr", "MASS", "Matrix", "MatrixModels", "memoise", "nnet", "pacman", "pbapply", "pillar", "purrr", "quantreg", "R6", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sessioninfo", "sp", "spacetime", "SparseM", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "xml2", "xts", "yaml", "zoo"]
## RUN ["installGithub.r", "r-lib/pkgdown@5e48258"]
## WORKDIR /payload/
## CMD ["R"]</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">print</span>(df_devtools)</a></code></pre></div>
<pre><code>## FROM rocker/r-ver:3.4.4
## LABEL maintainer="daniel"
## RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
##   &amp;&amp; apt-get install -y git-core \
##  libapparmor-dev \
##  libcurl4-openssl-dev \
##  libssl-dev \
##  libudunits2-dev \
##  libxml2-dev \
##  make \
##  pandoc \
##  pandoc-citeproc \
##  udunits
## RUN ["install2.r", "A3", "abc", "abc.data", "assertthat", "automagic", "backports", "bindrcpp", "class", "classInt", "clisymbols", "codetools", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "knitr", "lambda.r", "lattice", "locfit", "magrittr", "MASS", "Matrix", "MatrixModels", "memoise", "nnet", "pacman", "pbapply", "pillar", "purrr", "quantreg", "R6", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sessioninfo", "sp", "spacetime", "SparseM", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "xml2", "xts", "yaml", "zoo"]
## RUN ["installGithub.r", "r-lib/pkgdown@5e48258"]
## WORKDIR /payload/
## CMD ["R"]</code></pre>
</div>
</div>
<div id="including-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#including-resources" class="anchor"></a>3. Including resources</h2>
<p>Analyses in R often rely on external files and resources that are located located in the workspace. When scripts or R markdown files are packaged, they are copied by default into the same location relative to the working directory. The argument <code>copy</code> influences how <code>dockefile()</code> behaves in this matter. It can either have the values <code>script</code> (default behaviour), <code>script_dir</code> (copies the complete directory in which the input file is located), or a custom list of files and directories inside the current working directory</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">file.copy</span>(<span class="dt">from =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/system.file">system.file</a></span>(<span class="st">"simple_test_script_resources"</span>, </a>
<a class="sourceLine" id="cb40-2" data-line-number="2">                             <span class="dt">package =</span> <span class="st">"containerit"</span>),</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">          <span class="dt">to =</span> temp_workspace, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">setwd</span>(<span class="kw">file.path</span>(temp_workspace, <span class="st">"simple_test_script_resources"</span>))</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">dockerfile_resources &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="st">"."</span>,</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">              <span class="dt">copy =</span> <span class="st">"script_dir"</span>,</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">              <span class="dt">cmd =</span> <span class="kw"><a href="../reference/CMD_Rscript.html">CMD_Rscript</a></span>(<span class="st">"simple_test.R"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">print</span>(dockerfile_resources)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
WORKDIR /payload/
COPY [".", "./"]
CMD ["R", "--vanilla", "-f", "simple_test.R"]</code></pre>
<p>Including R objects works similar to resources, using the argument <code>save_image</code>. The argument can be set to <code>TRUE</code> to save <em>all</em> objects of the current workspace to an .Rdata file, which is then copied to the container’s working directory and loaded on startup (based on <code>save.image()</code>).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">save_image =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>Warning in FUN(X[[i]], ...): Failed to identify a source for package containerit. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>Warning in FUN(X[[i]], ...): Failed to identify a source for package harbor. Therefore the package cannot be installed in the Docker image.</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
  &amp;&amp; apt-get install -y git-core \
    libapparmor-dev \
    libcurl4-openssl-dev \
    libssl-dev \
    libudunits2-dev \
    libxml2-dev \
    make \
    pandoc \
    pandoc-citeproc \
    udunits
RUN ["install2.r", "abc.data", "assertthat", "automagic", "backports", "bindr", "bindrcpp", "class", "classInt", "clisymbols", "codetools", "colorspace", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "fs", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "jsonlite", "knitr", "lambda.r", "lattice", "locfit", "magrittr", "MASS", "Matrix", "MatrixModels", "memoise", "munsell", "nnet", "pacman", "pbapply", "pillar", "pkgconfig", "plyr", "purrr", "quantreg", "R6", "Rcpp", "remotes", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sessioninfo", "sp", "spacetime", "SparseM", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "withr", "xml2", "xtable", "xts", "yaml", "zoo"]
RUN ["installGithub.r", "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910"]
WORKDIR /payload/
COPY ["./.Rdata", "./"]
CMD ["R"]</code></pre>
<p>Alternatively, a object names as well as other arguments can be passed as a list, which then are passed to the <code>save()</code> function.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">require</span>(fortunes)</a></code></pre></div>
<pre><code>## Loading required package: fortunes</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">calculation &lt;-<span class="st"> </span><span class="dv">41</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">frtn &lt;-<span class="st"> </span>fortunes<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/fortunes/topics/fortunes">fortune</a></span>()</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">original_sessionInfo &lt;-<span class="st"> </span><span class="kw">sessionInfo</span>()</a>
<a class="sourceLine" id="cb52-5" data-line-number="5"></a>
<a class="sourceLine" id="cb52-6" data-line-number="6">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">silent =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb52-7" data-line-number="7">                 <span class="dt">save_image =</span> <span class="kw">list</span>(<span class="st">"original_sessionInfo"</span>, <span class="st">"frtn"</span>))</a></code></pre></div>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package containerit. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package harbor. Therefore the package cannot be installed in the Docker image.</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">print</span>(df)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="daniel"
RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
  &amp;&amp; apt-get install -y git-core \
    libapparmor-dev \
    libcurl4-openssl-dev \
    libssl-dev \
    libudunits2-dev \
    libxml2-dev \
    make \
    pandoc \
    pandoc-citeproc \
    udunits
RUN ["install2.r", "abc.data", "assertthat", "automagic", "backports", "bindr", "bindrcpp", "class", "classInt", "clisymbols", "codetools", "colorspace", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "fortunes", "fs", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "jsonlite", "knitr", "lambda.r", "lattice", "locfit", "magrittr", "MASS", "Matrix", "MatrixModels", "memoise", "munsell", "nnet", "pacman", "pbapply", "pillar", "pkgconfig", "plyr", "purrr", "quantreg", "R6", "Rcpp", "remotes", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sessioninfo", "sp", "spacetime", "SparseM", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "withr", "xml2", "xtable", "xts", "yaml", "zoo"]
RUN ["installGithub.r", "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910"]
WORKDIR /payload/
COPY ["./payload.Rdata", "./payload.Rdata"]
CMD ["R"]</code></pre>
</div>
<div id="advanced-dockerfile-instructions" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-dockerfile-instructions" class="anchor"></a>4. Advanced Dockerfile instructions</h2>
<div id="image-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#image-metadata" class="anchor"></a>4.1 Image metadata</h3>
<p>Metadata can be added to Docker images using <a href="https://docs.docker.com/engine/reference/builder/#label">Label instructions</a>. Label instructions are key-value pairs of arbitrary content. A dublicate key overwrites existing ones. Although it is up to the user how many labels are created, it is recommended to bundle them into one Label instruction in the Dockerfile. Each use of the <code><a href="../reference/Label.html">Label()</a></code> function creates a seperate instruction in the Dockerfile.</p>
<p>As shown in section 2, the maintainer label is set by default to the top as the dockerfile and contains the username of the current host system. The maintainer can be changed with the <code>maintainer</code> argument of <code><a href="../reference/dockerfile.html">dockerfile()</a></code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">labeled_dockerfile &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="kw"><a href="../reference/clean_session.html">clean_session</a></span>(), <span class="dt">maintainer =</span> <span class="st">"Jon_Doe@example.com"</span>)</a></code></pre></div>
<p>Labels can be applied to the existing Dockerfile object using the <code>addInstructions()</code> function, which adds any newly created instructions to the end of the Dockerfile but before the CMD statement. The <code><a href="../reference/Label.html">Label()</a></code> constructor can be used for creating labels of arbitrary content and works similar to creating named lists in R.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="co"># A simple label that occupies one line:</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2">label1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Label.html">Label</a></span>(<span class="dt">key1 =</span> <span class="st">"this"</span>, <span class="dt">key2 =</span> <span class="st">"that"</span>, <span class="dt">otherKey =</span> <span class="st">"content"</span>)</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="kw">addInstruction</span>(labeled_dockerfile) &lt;-<span class="st"> </span>label1</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"></a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="co">#label with fixed namespace for all keys</span></a>
<a class="sourceLine" id="cb58-6" data-line-number="6">label2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Label.html">Label</a></span>(<span class="st">"name"</span>=<span class="st">"A name"</span>, <span class="st">"description"</span> =<span class="st"> "A description"</span>, <span class="dt">label_ns =</span> <span class="st">"my.label.ns."</span>)</a>
<a class="sourceLine" id="cb58-7" data-line-number="7"></a>
<a class="sourceLine" id="cb58-8" data-line-number="8"><span class="co"># A multiline label with one key/value pair per line</span></a>
<a class="sourceLine" id="cb58-9" data-line-number="9">label3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Label.html">Label</a></span>(<span class="st">"info.o2r.name"</span> =<span class="st"> "myProject_ImageName"</span>, <span class="st">"org.label-schema.name"</span>=<span class="st">"ImageName"</span>, </a>
<a class="sourceLine" id="cb58-10" data-line-number="10">                <span class="st">"yet.another_labelname"</span>=<span class="st">"true"</span>, <span class="dt">multi_line =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb58-11" data-line-number="11"><span class="kw">addInstruction</span>(labeled_dockerfile) &lt;-<span class="st"> </span><span class="kw">list</span>(label2, label3)</a></code></pre></div>
<p>Metadata according to the <a href="http://label-schema.org/rc1/">Label Schema</a> conventions can be created with a function constructed by the helper factory <code><a href="../reference/LabelSchemaFactory.html">LabelSchemaFactory()</a></code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">Label_LabelSchema &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LabelSchemaFactory.html">LabelSchemaFactory</a></span>()</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">label &lt;-<span class="st"> </span><span class="kw">Label_LabelSchema</span>(<span class="dt">name =</span> <span class="st">"ImageName"</span>, <span class="dt">description =</span> <span class="st">"Description of the image"</span>, <span class="dt">build_date =</span> <span class="kw">Sys.time</span>())</a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="kw">addInstruction</span>(labeled_dockerfile) &lt;-<span class="st"> </span>label</a></code></pre></div>
<p>You can also put session information, using either base R or <code>devtools</code>, into a label as plain text or as json:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">addInstruction</span>(labeled_dockerfile) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Label_SessionInfo.html">Label_SessionInfo</a></span>(<span class="dt">session =</span> <span class="kw"><a href="../reference/clean_session.html">clean_session</a></span>())</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">addInstruction</span>(labeled_dockerfile) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Label_SessionInfo.html">Label_SessionInfo</a></span>(<span class="dt">session =</span> devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/session_info">session_info</a></span>(), <span class="dt">as_json =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>The resulting Dockerfile with all the labels:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">print</span>(labeled_dockerfile)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.4.4
LABEL maintainer="Jon_Doe@example.com"
WORKDIR /payload/
LABEL key1="this" key2="that" otherKey="content"
LABEL my.label.ns.name="A name" my.label.ns.description="A description"
LABEL info.o2r.name="myProject_ImageName" \
    org.label-schema.name="ImageName" \
    yet.another_labelname="true"
LABEL org.label-schema.schema-version="1.0.0-rc.1" \
    org.label-schema.build-date="2018-03-26T22:23:43+0200" \
    org.label-schema.name="ImageName" \
    org.label-schema.description="Description of the image"
LABEL R.session-info="R version 3.4.4 (2018-03-15)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 16.04.4 LTS\n\nMatrix products: default\nBLAS: /usr/lib/libblas/libblas.so.3.6.0\nLAPACK: /usr/lib/lapack/liblapack.so.3.6.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n[1] compiler_3.4.4"
LABEL R.session-info="{\"platform\":{\"version\":\"R version 3.4.4 (2018-03-15)\",\"system\":\"x86_64, linux-gnu\",\"ui\":\"X11\",\"language\":\"en\",\"collate\":\"en_US.UTF-8\",\"tz\":\"Europe/Berlin\",\"date\":\"2018-03-26\"},\"packages\":{\"package\":[\"abc.data\",\"assertthat\",\"automagic\",\"backports\",\"base\",\"bindr\",\"bindrcpp\",\"class\",\"classInt\",\"clisymbols\",\"codetools\",\"colorspace\",\"commonmark\",\"compiler\",\"containerit\",\"crayon\",\"curl\",\"data.table\",\"datasets\",\"DBI\",\"desc\",\"devtools\",\"digest\",\"dplyr\",\"e1071\",\"evaluate\",\"FNN\",\"formatR\",\"fortunes\",\"fs\",\"futile.logger\",\"futile.options\",\"githubinstall\",\"glue\",\"graphics\",\"grDevices\",\"grid\",\"gstat\",\"harbor\",\"htmltools\",\"httr\",\"intervals\",\"jsonlite\",\"knitr\",\"lambda.r\",\"lattice\",\"locfit\",\"magrittr\",\"MASS\",\"Matrix\",\"MatrixModels\",\"memoise\",\"methods\",\"munsell\",\"nnet\",\"pacman\",\"parallel\",\"pbapply\",\"pillar\",\"pkgconfig\",\"pkgdown\",\"plyr\",\"purrr\",\"quantreg\",\"R6\",\"Rcpp\",\"rjson\",\"rlang\",\"rmarkdown\",\"roxygen2\",\"rprojroot\",\"rstudioapi\",\"scales\",\"semver\",\"sessioninfo\",\"sp\",\"spacetime\",\"SparseM\",\"stats\",\"stringi\",\"stringr\",\"sys\",\"tibble\",\"tools\",\"udunits2\",\"units\",\"utils\",\"withr\",\"xml2\",\"xtable\",\"xts\",\"yaml\",\"zoo\"],\"*\":[\"*\",\"\",\"\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"*\",\"\",\"\",\"\",\"*\",\"\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"*\",\"*\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"*\",\"\",\"\",\"*\",\"\",\"*\",\"\",\"\",\"\",\"*\",\"\",\"*\",\"\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"*\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"*\",\"*\",\"\",\"*\",\"*\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"*\",\"\",\"\",\"*\",\"\",\"\",\"\"],\"version\":[\"1.0\",\"0.2.0\",\"0.3\",\"1.1.2\",\"3.4.4\",\"0.1\",\"0.2\",\"7.3-14\",\"0.1-24\",\"1.2.0\",\"0.2-15\",\"1.3-2\",\"1.4\",\"3.4.4\",\"0.3.0\",\"1.3.4\",\"3.1\",\"1.10.4-3\",\"3.4.4\",\"0.8\",\"1.1.1\",\"1.13.5\",\"0.6.15\",\"0.7.4\",\"1.6-8\",\"0.10.1\",\"1.1\",\"1.5\",\"1.5-4\",\"1.2.2\",\"1.4.3\",\"1.0.0\",\"0.2.2\",\"1.2.0\",\"3.4.4\",\"3.4.4\",\"3.4.4\",\"1.1-5\",\"0.2.0\",\"0.3.6\",\"1.3.1\",\"0.15.1\",\"1.5\",\"1.20\",\"1.2\",\"0.20-35\",\"1.5-9.1\",\"1.5\",\"7.3-49\",\"1.2-12\",\"0.4-1\",\"1.1.0\",\"3.4.4\",\"0.4.3\",\"7.3-12\",\"0.4.6\",\"3.4.4\",\"1.3-4\",\"1.2.1\",\"2.0.1\",\"0.1.0.9000\",\"1.8.4\",\"0.2.4\",\"5.35\",\"2.2.2\",\"0.12.16\",\"0.2.15\",\"0.2.0\",\"1.9\",\"6.0.1\",\"1.3-2\",\"0.7\",\"0.5.0\",\"0.2.0\",\"1.0.0\",\"1.2-7\",\"1.2-1\",\"1.77\",\"3.4.4\",\"1.1.6\",\"1.3.0\",\"1.5\",\"1.4.2\",\"3.4.4\",\"0.13\",\"0.5-1\",\"3.4.4\",\"2.1.2\",\"1.2.0\",\"1.8-2\",\"0.10-2\",\"2.1.18\",\"1.8-1\"],\"date\":[\"2015-05-05\",\"2017-04-11\",\"2017-02-26\",\"2017-12-13\",\"2018-03-16\",\"2016-11-13\",\"2017-06-17\",\"2015-08-30\",\"2017-04-16\",\"2017-05-21\",\"2016-10-05\",\"2016-12-14\",\"2017-09-01\",\"2018-03-16\",\"2018-03-26\",\"2017-09-16\",\"2017-12-12\",\"2017-10-27\",\"2018-03-16\",\"2018-03-02\",\"2017-08-03\",\"2018-02-18\",\"2018-01-28\",\"2017-09-28\",\"2017-02-02\",\"2017-06-24\",\"2013-07-31\",\"2017-04-25\",\"2016-12-29\",\"2018-03-21\",\"2016-07-10\",\"2010-04-06\",\"2018-02-18\",\"2017-10-29\",\"2018-03-16\",\"2018-03-16\",\"2018-03-16\",\"2017-03-12\",\"2018-01-05\",\"2017-04-28\",\"2017-08-20\",\"2015-08-27\",\"2017-06-01\",\"2018-02-20\",\"2017-09-16\",\"2017-03-25\",\"2013-04-20\",\"2014-11-22\",\"2018-02-23\",\"2017-11-16\",\"2015-08-22\",\"2017-04-21\",\"2018-03-16\",\"2016-02-13\",\"2016-02-02\",\"2017-05-14\",\"2018-03-16\",\"2018-01-10\",\"2018-02-27\",\"2017-03-21\",\"2018-03-25\",\"2016-06-08\",\"2017-10-18\",\"2018-02-02\",\"2017-06-17\",\"2018-03-13\",\"2014-11-03\",\"2018-02-20\",\"2018-03-01\",\"2017-02-06\",\"2018-01-03\",\"2017-09-07\",\"2017-08-24\",\"2017-01-06\",\"2017-06-21\",\"2018-01-19\",\"2017-09-24\",\"2017-04-23\",\"2018-03-16\",\"2017-11-17\",\"2018-02-19\",\"2017-10-10\",\"2018-01-22\",\"2018-03-16\",\"2016-11-17\",\"2018-01-08\",\"2018-03-16\",\"2018-03-15\",\"2018-01-24\",\"2016-02-05\",\"2018-03-14\",\"2018-03-08\",\"2018-01-08\"],\"source\":[\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.3)\",\"local\",\"cran (@0.1)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.3.1)\",\"cran (@1.3-2)\",\"CRAN (R 3.4.1)\",\"local\",\"local\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.2)\",\"local\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.0)\",\"cran (@1.2.2)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.2)\",\"local\",\"local\",\"local\",\"CRAN (R 3.4.0)\",\"local\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.4.0)\",\"cran (@1.5)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.3.3)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.3)\",\"local\",\"cran (@0.4.3)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.4)\",\"local\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.3)\",\"cran (@2.0.1)\",\"Github (r-lib/pkgdown@5e48258)\",\"cran (@1.8.4)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.0)\",\"cran (@0.12.16)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.4.1)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.4)\",\"local\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.2)\",\"CRAN (R 3.4.3)\",\"local\",\"CRAN (R 3.4.0)\",\"CRAN (R 3.4.3)\",\"local\",\"cran (@2.1.2)\",\"CRAN (R 3.4.3)\",\"cran (@1.8-2)\",\"CRAN (R 3.4.4)\",\"CRAN (R 3.4.3)\",\"CRAN (R 3.4.3)\"]}}"
CMD ["R"]</code></pre>
</div>
<div id="exposing-ports" class="section level3">
<h3 class="hasAnchor">
<a href="#exposing-ports" class="anchor"></a>4.2 Exposing ports</h3>
<p>If a Dockerfile contains a web service, specific ports of a running container might need to be exposed.</p>
<blockquote>
<p>The EXPOSE instruction informs Docker that the container listens on the specified network ports at runtime. [..] It functions as a type of documentation between the person who builds the image and the person who runs the container, [..] To actually publish the port when running the container, use the -p flag on docker run to publish and map one or more ports [..] (<a href="https://docs.docker.com/engine/reference/builder/#expose">Docker docs</a>)</p>
</blockquote>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">dockerfile_with_expose &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>()</a></code></pre></div>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package containerit. Therefore the package cannot be installed in the Docker image.</code></pre>
<pre><code>## Warning in FUN(X[[i]], ...): Failed to identify a source for package harbor. Therefore the package cannot be installed in the Docker image.</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">my_port_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Expose.html">Expose</a></span>(<span class="dv">8000</span>)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">my_port_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Expose.html">Expose</a></span>(<span class="dt">port =</span> <span class="st">"80/tcp"</span>, <span class="dt">host =</span> <span class="dv">8080</span>)</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="kw">addInstruction</span>(dockerfile_with_expose) &lt;-<span class="st"> </span><span class="kw">list</span>(my_port_<span class="dv">1</span>, my_port_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="kw">print</span>(dockerfile_with_expose)</a></code></pre></div>
<pre><code>## FROM rocker/r-ver:3.4.4
## LABEL maintainer="daniel"
## RUN export DEBIAN_FRONTEND=noninteractive; apt-get -y update \
##   &amp;&amp; apt-get install -y git-core \
##  libapparmor-dev \
##  libcurl4-openssl-dev \
##  libssl-dev \
##  libudunits2-dev \
##  libxml2-dev \
##  make \
##  pandoc \
##  pandoc-citeproc \
##  udunits
## RUN ["install2.r", "abc.data", "assertthat", "automagic", "backports", "bindr", "bindrcpp", "class", "classInt", "clisymbols", "codetools", "colorspace", "commonmark", "crayon", "curl", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "e1071", "evaluate", "FNN", "formatR", "fortunes", "fs", "futile.logger", "futile.options", "githubinstall", "glue", "gstat", "htmltools", "httr", "intervals", "jsonlite", "knitr", "lambda.r", "lattice", "locfit", "magrittr", "MASS", "Matrix", "MatrixModels", "memoise", "munsell", "nnet", "pacman", "pbapply", "pillar", "pkgconfig", "plyr", "purrr", "quantreg", "R6", "Rcpp", "remotes", "rjson", "rlang", "rmarkdown", "roxygen2", "rprojroot", "rstudioapi", "scales", "semver", "sessioninfo", "sp", "spacetime", "SparseM", "stringi", "stringr", "sys", "tibble", "udunits2", "units", "withr", "xml2", "xtable", "xts", "yaml", "zoo"]
## RUN ["installGithub.r", "r-lib/pkgdown@5e4825875751c009444c56ce43d06324ec53e910"]
## WORKDIR /payload/
## EXPOSE 8000
## EXPOSE 8080 80/tcp
## CMD ["R"]</code></pre>
</div>
<div id="entrypoint-and-command" class="section level3">
<h3 class="hasAnchor">
<a href="#entrypoint-and-command" class="anchor"></a>4.3 Entrypoint and command</h3>
<p>The <code>ENTRYPOINT</code> instruction allows using a container like a binary executable. The actually executed command is constructed from both <code>ENTRYPOINT</code> and <code>CMD</code> instructions - please check the <a href="https://docs.docker.com/engine/reference/builder/#entrypoint">Docker docs</a> for details. The <code>entrypoint</code> parameter of the <code><a href="../reference/dockerfile.html">dockerfile()</a></code> function supports both “forms” as shown below.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">ep_exec &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Entrypoint.html">Entrypoint</a></span>(<span class="dt">program =</span> <span class="st">"R"</span>,</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">                 <span class="dt">params =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">                   <span class="st">"-e"</span>,</a>
<a class="sourceLine" id="cb68-4" data-line-number="4">                   <span class="st">"pr &lt;- plumber::plumb(commandArgs()[4]); pr$run(host='0.0.0.0', port=8080)"</span>),</a>
<a class="sourceLine" id="cb68-5" data-line-number="5">                 <span class="dt">form =</span> <span class="st">"exec"</span>)</a>
<a class="sourceLine" id="cb68-6" data-line-number="6">dockerfile_with_entrypoint &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb68-7" data-line-number="7">                                         <span class="dt">image =</span> <span class="st">"trestletech/plumber"</span>,</a>
<a class="sourceLine" id="cb68-8" data-line-number="8">                                         <span class="dt">entrypoint =</span> ep_exec,</a>
<a class="sourceLine" id="cb68-9" data-line-number="9">                                         <span class="dt">cmd =</span> <span class="kw"><a href="../reference/Cmd.html">Cmd</a></span>(<span class="st">"schedule.R"</span>))</a>
<a class="sourceLine" id="cb68-10" data-line-number="10"><span class="kw">print</span>(dockerfile_with_entrypoint)</a></code></pre></div>
<pre><code>## FROM trestletech/plumber
## LABEL maintainer="daniel"
## WORKDIR /payload/
## ENTRYPOINT ["R", "-e", "pr &lt;- plumber::plumb(commandArgs()[4]); pr$run(host='0.0.0.0', port=8080)"]
## CMD ["schedule.R"]</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">ep_shell &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Entrypoint.html">Entrypoint</a></span>(<span class="dt">program =</span> <span class="st">"R"</span>,</a>
<a class="sourceLine" id="cb70-2" data-line-number="2">                 <span class="dt">params =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb70-3" data-line-number="3">                   <span class="st">"-e"</span>,</a>
<a class="sourceLine" id="cb70-4" data-line-number="4">                   <span class="st">"pr &lt;- plumber::plumb(commandArgs()[4]); pr$run(host='0.0.0.0', port=8080)"</span>),</a>
<a class="sourceLine" id="cb70-5" data-line-number="5">                 <span class="dt">form =</span> <span class="st">"shell"</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6">dockerfile_with_entrypoint &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb70-7" data-line-number="7">                                         <span class="dt">image =</span> <span class="st">"trestletech/plumber"</span>,</a>
<a class="sourceLine" id="cb70-8" data-line-number="8">                                         <span class="dt">entrypoint =</span> ep_shell,</a>
<a class="sourceLine" id="cb70-9" data-line-number="9">                                         <span class="dt">cmd =</span> <span class="kw"><a href="../reference/Cmd.html">Cmd</a></span>(<span class="st">"schedule.R"</span>, <span class="dt">form =</span> <span class="st">"shell"</span>))</a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="kw">print</span>(dockerfile_with_entrypoint)</a></code></pre></div>
<pre><code>## FROM trestletech/plumber
## LABEL maintainer="daniel"
## WORKDIR /payload/
## ENTRYPOINT R -e pr &lt;- plumber::plumb(commandArgs()[4]); pr$run(host='0.0.0.0', port=8080)
## CMD schedule.R</code></pre>
</div>
<div id="comments" class="section level3">
<h3 class="hasAnchor">
<a href="#comments" class="anchor"></a>4.4 Comments</h3>
<p>Comments can be added to a Dockerfile. By default they are the last instruction.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">df_comment &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>, <span class="dt">image =</span> <span class="kw"><a href="../reference/getImageForVersion.html">getImageForVersion</a></span>(<span class="st">"3.3.3"</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="kw">addInstruction</span>(df_comment) &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Comment.html">Comment</a></span>(<span class="dt">text =</span> <span class="st">"Don't forget about this!"</span>)</a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="kw">print</span>(df_comment)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.3.3
LABEL maintainer="daniel"
WORKDIR /payload/
# Don't forget about this!
CMD ["R"]</code></pre>
</div>
</div>
<div id="custom-base-image" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-base-image" class="anchor"></a>5. Custom base image</h2>
<p>The <code><a href="../reference/dockerfile.html">dockerfile()</a></code> function allows further customization regarding the R version or the used base image (cf. Rocker stack). Note that while choosing an R version for the Dockerfile explicitly is possible, the session to generate the required information (i.e. which packages are attached etc.) is still running the R version of the generating machine.</p>
<p>The following examples show usage of these options and the respective <code>FROM</code> statements in the Dockerfile.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">df_custom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>, <span class="dt">image =</span> <span class="kw"><a href="../reference/getImageForVersion.html">getImageForVersion</a></span>(<span class="st">"3.3.3"</span>), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="kw">print</span>(df_custom<span class="op">@</span>image)</a></code></pre></div>
<pre><code>FROM rocker/r-ver:3.3.3</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">df_custom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>, <span class="dt">image =</span> <span class="st">"rocker/geospatial"</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="kw">print</span>(df_custom<span class="op">@</span>image)</a></code></pre></div>
<pre><code>FROM rocker/geospatial</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">df_custom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> <span class="ot">NULL</span>, <span class="dt">image =</span> <span class="st">"rocker/verse:3.0.0"</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)<span class="op">@</span>image</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="kw">print</span>(df_custom<span class="op">@</span>image)</a></code></pre></div>
<pre><code>[1] "rocker/verse"</code></pre>
<p>When you change the base image, you might not want to re-install packages that are already in the base image. The helper function <code><a href="../reference/get_installed_packages.html">get_installed_packages()</a></code> is used internally to filter the installed packages and can be activated with <code>filter_baseimage_pkgs</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">expressions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">library</span>(<span class="st">"sp"</span>)),</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">                 <span class="kw">expression</span>(<span class="kw">library</span>(<span class="st">"cshapes"</span>)))</a>
<a class="sourceLine" id="cb80-3" data-line-number="3">session &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clean_session.html">clean_session</a></span>(expressions, <span class="dt">echo =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb80-4" data-line-number="4">df_filtered &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dockerfile.html">dockerfile</a></span>(<span class="dt">from =</span> session, <span class="dt">maintainer =</span> <span class="st">"o2r"</span>,</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">                   <span class="dt">image =</span> <span class="st">"rocker/geospatial:3.4.4"</span>,</a>
<a class="sourceLine" id="cb80-6" data-line-number="6">                   <span class="dt">filter_baseimage_pkgs =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb80-7" data-line-number="7"><span class="kw">print</span>(df_filtered)</a></code></pre></div>
<pre><code>FROM rocker/geospatial:3.4.4
LABEL maintainer="o2r"
# Packages skipped because they are in the base image: foreign, lattice, maptools, plyr, Rcpp, sp
RUN ["install2.r", "cshapes"]
WORKDIR /payload/
CMD ["R"]</code></pre>
</div>
<div id="cli" class="section level2">
<h2 class="hasAnchor">
<a href="#cli" class="anchor"></a>6. CLI</h2>
<p>A command line interface to the package functions is also available for Linux based on <a href="https://github.com/docopt/docopt.R">docopt.R</a>. This allows integration into workflows and tools written in other programming languages than R.</p>
<p>You can make the command <code>containerit</code> available on your maching by linking the R script file delivered with the package as follows:</p>
<p><code>ln -s $(Rscript -e "cat(system.file(\"cli/container_it.R\", package=\"containerit\"))") /usr/local/bin/containerit</code></p>
<p>CLI Examples:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb82-1" data-line-number="1">  <span class="ex">containerit</span> --help</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb82-3" data-line-number="3">  <span class="co"># runs the first R markdown or R script file locally </span></a>
<a class="sourceLine" id="cb82-4" data-line-number="4">  <span class="co"># prints Dockerfile without writing a file</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5">  <span class="ex">containerit</span> dir -p --no-write  </a>
<a class="sourceLine" id="cb82-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb82-7" data-line-number="7">  <span class="co"># Packages R-script </span></a>
<a class="sourceLine" id="cb82-8" data-line-number="8">  <span class="co"># saves a workspace image (-i parameter)</span></a>
<a class="sourceLine" id="cb82-9" data-line-number="9">  <span class="co"># Writes Dockerfile (overwrite with -f)</span></a>
<a class="sourceLine" id="cb82-10" data-line-number="10">  <span class="co"># execute the script on start-up</span></a>
<a class="sourceLine" id="cb82-11" data-line-number="11">  <span class="ex">containerit</span> file -ifp --cmd-R-file path/example.R</a>
<a class="sourceLine" id="cb82-12" data-line-number="12"></a>
<a class="sourceLine" id="cb82-13" data-line-number="13">  <span class="co"># Creates an empty R session with the given R commands</span></a>
<a class="sourceLine" id="cb82-14" data-line-number="14">  <span class="co"># Set R version of the container to 3.3.0</span></a>
<a class="sourceLine" id="cb82-15" data-line-number="15">  <span class="ex">containerit</span> session -p -e <span class="st">"library(sp)"</span> -e <span class="st">"demo(meuse, ask=FALSE)"</span></a></code></pre></div>
</div>
<div id="challenges" class="section level2">
<h2 class="hasAnchor">
<a href="#challenges" class="anchor"></a>7. Challenges</h2>
<p>We encountered several challenges during <code>containerit</code>’s development. First and foremost, a well known limitation is that R packages don’t define system dependencies and do not provide explicit versions for R package dependencies. The <code>sysreqs</code> package is a promising approach towards handling system requirements, but so far lists package names but does not provide version information. The <a href="https://github.com/rstudio/shinyapps-package-dependencies">shinyapps-package-dependencies</a> demonstrate a (currently system dependent) alternative. The high value of R might well lie in the fact that “packages currently on CRAN” should work well with each other.</p>
<p>An unmet challenge so far is the installation of specific versions of external libraries (see <a href="https://github.com/o2r-project/containerit/issues/46">issue</a>). A package like <code>sf</code> relies on well-tested and powerful system libraries, see <code><a href="http://www.rdocumentation.org/packages/sf/topics/sf_extSoftVersion">sf::sf_extSoftVersion()</a></code>, which ideally should be matched in the created container.</p>
<p>And of course users may do things that <code>containerit</code> cannot capture from the session state “after the analysis is completed”, such as detaching packages or removing relevant files, and unknown side-effects might occur.</p>
<p>All software is presumed to be installed and run on the host system. Although it is possible to use deviating versions of R or even create Dockerfiles using sessionInfo-objects created on a different host, this may lead to unexpected errors because the setup cannot be tested locally.</p>
</div>
<div id="conclusions-and-future-work" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusions-and-future-work" class="anchor"></a>8. Conclusions and future work</h2>
<p><code>containerit</code> alows to create and costumize Dockerfiles with minimal effort, which are suitable for packaging R analyses in the persistant runtime environment of a software container. So far, we were able to reproduce complete R sessions regarding loaded and attached packages and mitigate some challenges towards reproducible computational research.</p>
<p>Although we are able to package different versions of R, we still do not fully support the installation of specific versions of R packages and external software libraries, which R itself does not support. This should be tested in the future by evaluating version-stable package repositories like MRAN and GRAN or utility packages such as packrat – see the <a href="https://github.com/o2r-project/containerit/issues/new">GitHub issues</a> for the status of these plans or provide your own ideas there.</p>
<p>Related to installing specific versions is support for other package repositories, such as Bioconductor, git, BitBucket, or even local files. For now, it is recommended that users have all software up-to-date when building a software container, as the latest version are installed from CRAN during the image build, to have matching package versions between the creation runtime environment and the container. All Dockerfiles and instructions are adjusted to the Rocker image stack and assume a Debian/Linux operating system. As we are not yet supporting the build of Docker images from scratch, we are restricted to this setup.</p>
<p>The package is a first prototype available via GitHub. While a publication on CRAN is a goal, it should be preceded by feedback from the user community and ideally be accompanied by related packages, such as <a href="https://github.com/wch/harbor/issues/5">harbor</a>, being available on CRAN, too. The prototype of <code>containerit</code> was developed and tested only on Ubuntu/Linux, which should be extended before releasing a stable version on CRAN.</p>
<p>As part of the o2r project, it is planned to integrate <code>containerit</code> in a <a href="http://o2r.info/architecture">web service</a> for creating archivable research in form of <a href="https://doi.org/10.1045/january2017-nuest">Executable Research Compendia (ERC)</a>. Making <code>containerit</code> itself easier to use for end-users is a secondary but worthwhile goal, for example by building a graphical user interface for metadata creation. Country locales are also not supported yet. We may want to support other container OS (e.g. windows container or other Linux distributions) or even containerization solutions such as <a href="http://singularity.lbl.gov/">Singularity</a> or the <a href="https://www.opencontainers.org/">Open Container Initiative</a>’s (OCI) <a href="https://github.com/opencontainers/image-spec">Image Format</a>.</p>
<p>Feedback and contributions are highly welcome <a href="https://github.com/o2r-project/containerit/issues">on GitHub</a> or <a href="https://twitter.com/o2r_project">o2r_project</a> on Twitter.</p>
</div>
<div id="metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#metadata" class="anchor"></a>Metadata</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.4.4 (2018-03-15)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 16.04.4 LTS
## 
## Matrix products: default
## BLAS: /usr/lib/libblas/libblas.so.3.6.0
## LAPACK: /usr/lib/lapack/liblapack.so.3.6.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] fortunes_1.5-4    pbapply_1.3-4     xtable_1.8-2     
##  [4] locfit_1.5-9.1    MASS_7.3-49       quantreg_5.35    
##  [7] SparseM_1.77      nnet_7.3-12       abc.data_1.0     
## [10] sessioninfo_1.0.0 devtools_1.13.5   sp_1.2-7         
## [13] gstat_1.1-5       containerit_0.3.0 knitr_1.20       
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.3.1           jsonlite_1.5         assertthat_0.2.0    
##  [4] yaml_2.1.18          pillar_1.2.1         backports_1.1.2     
##  [7] lattice_0.20-35      glue_1.2.0           digest_0.6.15       
## [10] colorspace_1.3-2     htmltools_0.3.6      Matrix_1.2-12       
## [13] plyr_1.8.4           clisymbols_1.2.0     pkgconfig_2.0.1     
## [16] purrr_0.2.4          scales_0.5.0         intervals_0.15.1    
## [19] MatrixModels_0.4-1   tibble_1.4.2         pacman_0.4.6        
## [22] withr_2.1.2          magrittr_1.5         crayon_1.3.4        
## [25] memoise_1.1.0        evaluate_0.10.1      fs_1.2.2            
## [28] xts_0.10-2           xml2_1.2.0           class_7.3-14        
## [31] githubinstall_0.2.2  FNN_1.1              tools_3.4.4         
## [34] data.table_1.10.4-3  formatR_1.5          stringr_1.3.0       
## [37] munsell_0.4.3        lambda.r_1.2         bindrcpp_0.2        
## [40] compiler_3.4.4       pkgdown_0.1.0.9000   e1071_1.6-8         
## [43] spacetime_1.2-1      rlang_0.2.0          classInt_0.1-24     
## [46] futile.logger_1.4.3  units_0.5-1          grid_3.4.4          
## [49] rstudioapi_0.7       sys_1.5              rjson_0.2.15        
## [52] rmarkdown_1.9        codetools_0.2-15     DBI_0.8             
## [55] roxygen2_6.0.1       curl_3.1             R6_2.2.2            
## [58] zoo_1.8-1            dplyr_0.7.4          udunits2_0.13       
## [61] bindr_0.1            automagic_0.3        commonmark_1.4      
## [64] rprojroot_1.3-2      futile.options_1.0.0 semver_0.2.0        
## [67] desc_1.1.1           stringi_1.1.6        parallel_3.4.4      
## [70] Rcpp_0.12.16         harbor_0.2.0</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">1. Introduction</a></li>
      <li><a href="#creating-a-dockerfile">2. Creating a Dockerfile</a></li>
      <li><a href="#including-resources">3. Including resources</a></li>
      <li><a href="#advanced-dockerfile-instructions">4. Advanced Dockerfile instructions</a></li>
      <li><a href="#custom-base-image">5. Custom base image</a></li>
      <li><a href="#cli">6. CLI</a></li>
      <li><a href="#challenges">7. Challenges</a></li>
      <li><a href="#conclusions-and-future-work">8. Conclusions and future work</a></li>
      <li><a href="#metadata">Metadata</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Daniel Nuest, Matthias Hinz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
